<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- Prism VSCode-Like Theme -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" />
<link rel="icon" type="image/x-icon" href="templates/imghead.ico">

<!-- Prism Core (must load before any language) -->
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>

<link rel="stylesheet" href="templates/style.css">

    <title>Î Î±ÏÎ¿Ï…ÏƒÎ¯Î±ÏƒÎ· ÎˆÏÎ³Î¿Ï… RC</title>
    
</head>
<body>
    <header>
        <div></div>
        <nav>
    <a href="index.html">EN</a> |
    <a href="index-el.html">GR</a>
</nav>

        <nav>
            <a href="#">Î‘ÏÏ‡Î¹ÎºÎ®</a>
            <a href="#">Î£Ï‡ÎµÏ„Î¹ÎºÎ¬</a>
            <a href="#">Portfolio</a>
            <a href="https://www.instagram.com/stratakosmc/?hl=el">Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±</a>
        </nav>
    </header>

    <div class="main">
        <h1>Î¤Î·Î»ÎµÎºÎ±Ï„ÎµÏ…Î¸Ï…Î½ÏŒÎ¼ÎµÎ½Î¿ Î±Ï…Ï„Î¿ÎºÎ¯Î½Î·Ï„Î¿ online</h1>
        <p>Î‘Ï…Ï„ÏŒ Ï„Î¿ Î­ÏÎ³Î¿ Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¬Î¶ÎµÎ¹ Ï„Î· ÏÎ¿Î® ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚ ÎºÎ±Î¹ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±Ï‚ ÏƒÎµ Î­Î½Î± Ï„Î·Î»ÎµÎºÎ±Ï„ÎµÏ…Î¸Ï…Î½ÏŒÎ¼ÎµÎ½Î¿ ÏŒÏ‡Î·Î¼Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ESP32 ÎºÎ±Î¹ Î­Î»ÎµÎ³Ï‡Î¿ brushless ÎºÎ¹Î½Î·Ï„Î®ÏÎ±.</p>
    </div>

    <div class="gallery">
    <div class="image-box"><img src="templates/car.jpg" alt=""/></div>
    <div class="image-box"><img src="templates/blueprint.PNG" alt=""/></div>
    <div class="image-box"><img src="templates/dashboard.png" alt=""/></div>
    <div class="image-box"><img src="templates/img.JPEG" alt=""/></div>
</div>

<section style="width: 100%; max-width: 1000px; padding: 40px 20px; box-sizing: border-box;"></section>
        <div style="display: flex; flex-wrap: wrap; align-items: center; margin-bottom: 40px;"></div>
                <img src="templates/img.JPEG" alt="Î£Ï…ÏƒÎºÎµÏ…Î® 1" style="width: 100%; max-width: 300px; margin-right: 40px; flex-shrink: 0; border: 1px solid #ddd;" />
                <div style="flex: 1; min-width: 200px;">
                        <h2 style="margin-top: 0;">Î¥Î»Î¹ÎºÏŒ</h2>
                        <p>- Î¤Î·Î»ÎµÎºÎ±Ï„ÎµÏ…Î¸Ï…Î½ÏŒÎ¼ÎµÎ½Î¿ Î±Ï…Ï„Î¿ÎºÎ¯Î½Î·Ï„Î¿ Î¼Îµ brushless ÎºÎ¹Î½Î·Ï„Î®ÏÎ± ÎºÎ±Î¹ ESC<br>
                        - ÎœÏ€Î±Ï„Î±ÏÎ¯Î± Li-po<br>
                        - ESP32 Î¼Î¹ÎºÏÎ¿ÎµÎ»ÎµÎ³ÎºÏ„Î®Ï‚ <br>
                        - Android ÎºÎ¹Î½Î·Ï„ÏŒ</p>
                </div>
        </div>

        <div style="display: flex; flex-wrap: wrap; align-items: center; margin-bottom: 40px;"></div>
                <img src="templates/screen.png" alt="Î£Ï…ÏƒÎºÎµÏ…Î® 2" style="width: 100%; max-width: 300px; margin-right: 40px; flex-shrink: 0; border: 1px solid #ddd;" />
                <div style="flex: 1; min-width: 200px;">
                        <h2 style="margin-top: 0;">Î›Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ</h2>
                        <p> - C++ Î³Î¹Î± ESP32<br>
                        - Python Î³Î¹Î± backend ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±<br>
                        - HTML/CSS/JS Î³Î¹Î± ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ· frontend<br></p>
                        - ÎµÏ†Î±ÏÎ¼Î¿Î³Î® tailscale Î³Î¹Î± Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· & ÎµÏ†Î±ÏÎ¼Î¿Î³Î® IP Webcam Î³Î¹Î± streaming.
                </div>
        </div>

<section id="diagram-section" style="position: relative; height: 800px; background: #fff;">
        <

        <!-- ÎšÎ¿Ï…Ï„Î¹Î¬ ÎµÎ¾Î±ÏÏ„Î·Î¼Î¬Ï„Ï‰Î½ -->
        <div class="diagram-box" style="top: 20px; left: 340px;">
                <h4>Î¤Ï…Ï€Î¹ÎºÏŒ Î‘Î½Î±Î»Î¿Î³Î¹ÎºÏŒ Servo</h4>
                <img src="templates/servo.png" alt="Servo">
        </div>

        <div class="diagram-box" style="top: 300px; left: 30px;">
                <h4>ESP32</h4>
                <img src="templates/esp.png" alt="ESP32">
        </div>

        <div class="diagram-box" style="top: 300px; left: 340px;">
                <h4>Xiaomi</h4>
                <img src="templates/android.png" alt="ÎšÎ¹Î½Î·Ï„ÏŒ">
        </div>

        <div class="diagram-box" style="top: 20px; left: 630px;">
                <h4>ESC & ÎšÎ¹Î½Î·Ï„Î®ÏÎ±Ï‚</h4>
                <img src="templates/esc.png" alt="ÎšÎ¹Î½Î·Ï„Î®ÏÎ±Ï‚">
        </div>

        <div class="diagram-box" style="top: 300px; left: 630px;">
                <h4>ÎœÏ€Î±Ï„Î±ÏÎ¯Î± Li-Po</h4>
                <img src="templates/battery.png" alt="ÎœÏ€Î±Ï„Î±ÏÎ¯Î±">
        </div>

        <!-- Î’Î­Î»Î· SVG Î¼Îµ ÎµÏ„Î¹ÎºÎ­Ï„ÎµÏ‚ -->
        <svg width="100%" height="100%" style="position: absolute; top: 0; left: 0; pointer-events: none;">
                <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"></marker>
                                <polygon points="0 0, 10 3.5, 0 7" fill="orange" />
                        </marker>
                </defs>

                <path id="p1" d="M240,320 C300,300 330,100 380,100" />
                <path id="p2" d="M240,320 C300,320 330,320 380,320" />
                <path id="p3" d="M240,320 C270,350 630,350 630,100" />
                <path id="p4" d="M740,320 C700,300 670,200 670,100" />
                <path id="p5" d="M380,100 C430,100 580,100 630,100" />

                <!-- Î•Ï„Î¹ÎºÎ­Ï„ÎµÏ‚ -->
                <text>
                        <textPath href="#p1" startOffset="50%">Î£Î®Î¼Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ Servo</textPath>
                </text>
                <text>
                        <textPath href="#p2" startOffset="50%">ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬ Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ + Î¡ÎµÏÎ¼Î±Ï„Î¿Ï‚</textPath>
                </text>
                <text>
                        <textPath href="#p3" startOffset="50%">Î“ÎµÎ¯Ï‰ÏƒÎ·</textPath>
                </text>
                <text>
                        <textPath href="#p4" startOffset="50%">Î¡ÎµÏÎ¼Î± 7.4V</textPath>
                </text>
                <text>
                        <textPath href="#p5" startOffset="50%">Î¡ÎµÏÎ¼Î± ÎšÎ¹Î½Î·Ï„Î®ÏÎ±</textPath>
                </text>
        </svg>

        <!-- Animation Î¼Îµ scroll -->
        <script>
                const observer = new IntersectionObserver(entries => {
                        entries.forEach(entry => {
                                if (entry.isIntersecting) {
                                        document.querySelector('#diagram-section svg').classList.add('animate');
                                        observer.disconnect();
                                }
                        });
                }, { threshold: 0.3 });

                observer.observe(document.querySelector('#diagram-section'));
        </script>
</section>
<section class="steps-section">
        <h2 class="steps-title">Î ÏÏ‚ ÏƒÏ…Î½Î´Î­Î¿Î½Ï„Î±Î¹ ÏŒÎ»Î±</h2>

        <div class="step" onclick="toggleStep(this)">
                <div class="step-header">
                        <div class="step-number">1</div>
                        <div class="step-content">
                                <h3>ESP32</h3>
                                <p>ÎˆÎ½Î± ÎºÎ±Î»ÏÎ´Î¹Î¿ USB Type C Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ· Ï„Î¿Ï… ESP32 Î¼Îµ Ï„Î· ÏƒÏ…ÏƒÎºÎµÏ…Î® android. Î— ÏƒÏ…ÏƒÎºÎµÏ…Î® Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ ÏƒÏÎ½Î´ÎµÏƒÎ· Wifi<br>
                                Ï€Î¿Ï… ÏƒÏ…Î½Î´Î­ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿ ÎºÎ¹Î½Î·Ï„Î®Ï‚ Ï„Î·Î»ÎµÏ†Ï‰Î½Î¯Î±Ï‚. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ C++ Î³Î¹Î± Arduino Î³Î¹Î± Ï„Î¿Î½ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒ Ï„Î¿Ï… ESP32.<br>
                                Î¤Î¿ ESP32 Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ ÎµÎ½Ï„Î¿Î»Î­Ï‚ ÎºÎ±Î¹ ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Ï„Î¿ Ï„Î¹Î¼ÏŒÎ½Î¹ (Servo) & Ï„Î¿ Electronic Speed Controller (ESC).</p>
                        </div>
                </div>
        <div class="step-drawer">
                     <div class="slide drawer-content">
                        <pre><code class="language-cpp">
#include &lt;WiFi.h&gt;
#include &lt;PubSubClient.h&gt;
#include &lt;ESP32Servo.h&gt;
#include &lt;ArduinoJson.h&gt;

// Ï„Î¿ hotspot Ï„Î¿Ï… ÏƒÏ€Î¹Ï„Î¹Î¿Ï Î® Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Wi-Fi Î¼Îµ ÏƒÏÎ½Î´ÎµÏƒÎ· Internet
const char* SSID     = "Redmi10s";
const char* PASS     = "12345678";

// Î´Î·Î¼ÏŒÏƒÎ¹Î¿Ï‚ broker
const char* MQTT_BROKER = "broker.hivemq.com";
const int   MQTT_PORT   = 1883;
const char* TOPIC_INPUT = "myrc/car1/input";

WiFiClient    net;
PubSubClient  mqtt(net);

// pins
const int STEERING_PIN = 18;
const int ESC_PIN      = 19;

// servos
Servo steeringServo, esc;

// state
int steeringAngle = 90;
int throttlePWM   = 0;

// parse incoming MQTT JSON
void onMqttMessage(char* topic, byte* payload, unsigned int len) {
    // copy into a String
    String msg;
    for(int i = 0; i &lt; len; i++) msg += (char)payload[i];

    // expected: {"angle":â€¦, "pwm":â€¦, "gear":â€¦}
    StaticJsonDocument&lt;200&gt; doc;
    DeserializationError err = deserializeJson(doc, msg);
    if(err) {
        Serial.println("âŒ Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î± Î±Î½Î¬Î»Ï…ÏƒÎ·Ï‚ JSON");
        return;
    }
    steeringAngle = doc["angle"];
    throttlePWM   = doc["pwm"];
    Serial.printf("ğŸ“¥ MQTT â†’ angle=%d pwm=%d\n", steeringAngle, throttlePWM);
}

void setup() {
    Serial.begin(115200);
    WiFi.begin(SSID, PASS);
    while(WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.print(".");
    }
    Serial.println("\nâœ… Wi-Fi ÎµÎ½ÎµÏÎ³ÏŒ, IP=" + WiFi.localIP().toString());

    mqtt.setServer(MQTT_BROKER, MQTT_PORT);
    mqtt.setCallback(onMqttMessage);
    while(!mqtt.connected()) {
        Serial.print("â³ Î£ÏÎ½Î´ÎµÏƒÎ· Î¼Îµ MQTTâ€¦");
        if(mqtt.connect("ESP32RCCar")) {
            Serial.println("âœ…");
        } else {
            Serial.print(" Î±Ï€Î¿Ï„Ï…Ï‡Î¯Î±, rc=");
            Serial.print(mqtt.state());
            Serial.println(" ÎµÏ€Î±Î½Î¬Î»Î·ÏˆÎ· ÏƒÎµ 2s");
            delay(2000);
        }
    }
    mqtt.subscribe(TOPIC_INPUT);
    Serial.println("ğŸ”´ Î•Î³Î³ÏÎ±Ï†Î® ÏƒÏ„Î¿ " + String(TOPIC_INPUT));

    // attach servos/ESC
    steeringServo.setPeriodHertz(50);
    esc.setPeriodHertz(50);
    steeringServo.attach(STEERING_PIN, 500, 2500);
    esc.attach(ESC_PIN, 1000, 2000);

    // arm ESC
    esc.writeMicroseconds(2000); delay(500);
    esc.writeMicroseconds(1000); delay(500);
    esc.writeMicroseconds(1500); delay(500);
}

void loop() {
    mqtt.loop();  // pump incoming MQTT

    // drive
    steeringServo.write(steeringAngle);
    int us = map(throttlePWM, -255, 255, 1000, 2000);
    esc.writeMicroseconds(constrain(us, 1000, 2000));
}
</code></pre></div>
                </div>
                
            </div>
        </div>
    </div>

    <div class="step" onclick="toggleStep(this)">
        <div class="step-header">
            <div class="step-number">2</div>
            <div class="step-content">
                <h3>Î•Ï†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÎšÎ¹Î½Î·Ï„Î¿Ï</h3>
                <p>Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® IP Webcam Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î»Î®ÏˆÎ· Î²Î¯Î½Ï„ÎµÎ¿ ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï‡ÏÏŒÎ½Î¿ ÎºÎ±Î¹ Î¼ÎµÏ„Î¬Î´Î¿ÏƒÎ· ÏƒÏ„Î·Î½ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î± Ï„Î¿Ï… dashboard.<br>
                Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Tailscale Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Ï„ÏŒÏƒÎ¿ ÏƒÎµ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® ÏŒÏƒÎ¿ ÎºÎ±Î¹ ÏƒÎµ android Î³Î¹Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î±ÏƒÏ†Î±Î»Î¿ÏÏ‚ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ VPN.</p>
            </div>
        </div>
        <div class="step-drawer">
            <div class="carousel">
                <div class="slides"></div>
                    <div class="slide" style="background-image: url('templates/ipcam.png');">Î›Î¿Î³ÏŒÏ„Ï…Ï€Î¿ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ IP Webcam</div>
                    <div class="slide" style="background-image: url('templates/tailscale.png');">Î›Î¿Î³ÏŒÏ„Ï…Ï€Î¿ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Tailscale</div>
                    <div class="slide" style="background-image: url('templates/cam.png');">Î¤Î¿ ÎºÎ¹Î½Î·Ï„ÏŒ Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î·Î½ Î±ÎµÏÎ¿Ï„Î¿Î¼Î® ÎºÎ±Î¹ Î¼ÎµÏ„Î±Î´Î¯Î´ÎµÎ¹ Î¶Ï‰Î½Ï„Î±Î½Î¬ Î²Î¯Î½Ï„ÎµÎ¿</div>
                </div>
                <div class="dots">
                    <span onclick="goToSlide(this, 0)" class="dot active"></span>
                    <span onclick="goToSlide(this, 1)" class="dot"></span>
                    <span onclick="goToSlide(this, 2)" class="dot"></span>
                </div>
            </div>
        </div>
    </div>

    <div class="step" onclick="openDrawer(this)">
        <div class="step-header">
            <div class="step-number">3</div>
            <div class="step-content">
                <h3>Î‘ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î•Î»Î­Î³Ï‡Î¿Ï… ÎšÎ¹Î½Î·Ï„Î®ÏÎ±</h3>
                <p>Î‘Ï…Ï„Î® Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Python Flask Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î´Î¹ÎµÏ€Î±Ï†Î® ÎµÎ»Î­Î³Ï‡Î¿Ï… ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï‡ÏÏŒÎ½Î¿ Î³Î¹Î± Ï„Î¿ Ï„Î·Î»ÎµÎºÎ±Ï„ÎµÏ…Î¸Ï…Î½ÏŒÎ¼ÎµÎ½Î¿ Î±Ï…Ï„Î¿ÎºÎ¯Î½Î·Ï„Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®ÏÎ¹Î¿ PS4 ğŸ® ÎºÎ±Î¹ Android ÎºÎ¹Î½Î·Ï„ÏŒ Ï‰Ï‚ ÎºÎ¬Î¼ÎµÏÎ± ÎºÎ±Î¹ server.</p>
            </div>
    </div>
    <div class="step-drawer">
        <div class="carousel">
                <div class="slides">
        <pre><code class="language-python">
import os
import time
import json
import eventlet
eventlet.monkey_patch()

from flask import render_template

from flask import Flask, render_template, Response
from flask_socketio import SocketIO
import paho.mqtt.client as mqtt
import cv2    # â† Î½Î­Î¿

# â€” Î¡ÏÎ¸Î¼Î¹ÏƒÎ· Flask / Socket.IO â€”
app = Flask(__name__)
app.config['SECRET_KEY'] = 'rc-car-secret'
socketio = SocketIO(
        app,
        async_mode='eventlet',
        cors_allowed_origins="*",
        logger=True,
        engineio_logger=True
)

@app.route('/phone')
def phone():
        # ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Ï„Î¿ Ï€ÏÏŒÏ„Ï…Ï€Î¿ Ï„Î¿Ï… broadcaster ÎºÎ¹Î½Î·Ï„Î¿Ï
        return render_template('phone_loc.html')

# â€” Î¡ÏÎ¸Î¼Î¹ÏƒÎ· MQTT (Ï‡Ï‰ÏÎ¯Ï‚ Î±Î»Î»Î±Î³Î­Ï‚) â€”
MQTT_BROKER = os.getenv('MQTT_BROKER', 'broker.hivemq.com')
MQTT_PORT   = int(os.getenv('MQTT_PORT', '1883'))
TOPIC_INPUT = 'myrc/car1/input'
mqttc = mqtt.Client()
mqttc.connect(MQTT_BROKER, MQTT_PORT, keepalive=60)
mqttc.loop_start()

# â€” Gear & smoothing (Ï‡Ï‰ÏÎ¯Ï‚ Î±Î»Î»Î±Î³Î­Ï‚) â€”
GEAR_SCALE      = [0.0, 0.10, 0.3, 0.5, 0.7, 1.0]
SMOOTH          = 0.2
steer_smooth    = 0.0
throttle_smooth = 0.0
scale_smooth    = GEAR_SCALE[1]

# â€” Î¡ÏÎ¸Î¼Î¹ÏƒÎ· Î»Î®ÏˆÎ·Ï‚ ÎºÎ¬Î¼ÎµÏÎ±Ï‚ â€”  
# 0 = Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· webcam. Î‘Î»Î»Î¬Î¾Ï„Îµ ÏƒÎµ RTSP/MJPEG URL Î³Î¹Î± IP cams Î® "http://<phone>:8080/video"
camera = cv2.VideoCapture("http://100.83.193.15:8080/video") 
if not camera.isOpened():
        raise RuntimeError("Î”ÎµÎ½ Î®Ï„Î±Î½ Î´Ï…Î½Î±Ï„Î® Î· ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· Ï„Î·Ï‚ ÎºÎ¬Î¼ÎµÏÎ±Ï‚.")

def gen_frames():
        """Î Î±ÏÎ¬Î³ÎµÎ¹ ÎºÎ±ÏÎ­ ÎºÎ¬Î¼ÎµÏÎ±Ï‚ Ï‰Ï‚ multipart MJPEG."""
        while True:
                success, frame = camera.read()
                if not success:
                        break
                # Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬: resize, flip, overlay ÎºÎ»Ï€ ÎµÎ´Ï
                ret, buffer = cv2.imencode('.jpg', frame)
                jpg = buffer.tobytes()
                yield (b'--frame\r\n'
                             b'Content-Type: image/jpeg\r\n\r\n' + jpg + b'\r\n')

@app.route('/video_feed')
def video_feed():
        return Response(
                gen_frames(),
                mimetype='multipart/x-mixed-replace; boundary=frame'
        )

@app.route('/')
def index():
        # index.html Î¸Î± ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÏƒÎµÎ¹ Ï„Î¿ /video_feed
        return render_template('index.html')


@socketio.on('connect')
def handle_connect(auth):
        print(f"[{time.strftime('%H:%M:%S')}] Î£Ï…Î½Î´Î­Î¸Î·ÎºÎµ Ï„Î¿ dashboard")
        socketio.emit('telemetry', {
                'steering': 90,
                'throttle': 0,
                'gear': 1,
                'speed': 0.0
        })
@socketio.on('location')
def handle_location(data):
        # data == {'lat':â€¦, 'lng':â€¦}
        print(f"[{time.strftime('%H:%M:%S')}] ğŸ“ Î»Î®ÏˆÎ· Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±Ï‚:", data)
        socketio.emit('location', data)


@socketio.on('controller_input')
def handle_input(data):
        global steer_smooth, throttle_smooth, scale_smooth

        # (Î· Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎ± ÎµÎ¾Î¿Î¼Î¬Î»Ï…Î½ÏƒÎ·, MQTT publish, telemetry emitâ€¦)

        raw_steer = data.get('steering', 0.0)
        raw_thr   = data.get('throttle', 0.0)
        raw_brk   = data.get('brake', 0.0)
        gear      = data.get('gear', 1)

        steer_smooth += SMOOTH * (raw_steer - steer_smooth)
        angle = int((steer_smooth * 0.5 + 0.5) * 180)

        forward = -raw_brk if raw_brk > 0.1 else raw_thr
        throttle_smooth += SMOOTH * (forward - throttle_smooth)

        target_scale = GEAR_SCALE[gear]
        scale_smooth += SMOOTH * (target_scale - scale_smooth)

        pwm = int(throttle_smooth * scale_smooth * 255)

        payload = {'angle': angle,'pwm': pwm,'gear': gear}
        mqttc.publish(TOPIC_INPUT, json.dumps(payload), qos=0)

        speed = abs(pwm) * 0.2 * gear
        socketio.emit('telemetry', {
                'steering': angle,
                'throttle': pwm,
                'gear': gear,
                'speed': round(speed,1)
        })
@socketio.on('restart_esp')
def restart_esp():
        # Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÏƒÎ±Ï‚ Î³Î¹Î± ÎµÏ€Î±Î½ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· ESP (Ï€.Ï‡. ÎµÎ½Ï„Î¿Î»Î® serial Î® MQTT)
        print("Î–Î·Ï„Î®Î¸Î·ÎºÎµ ÎµÏ€Î±Î½ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· ESP")

@socketio.on('restart_hotspot')
def restart_hotspot():
        # Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÏƒÎ±Ï‚ Î³Î¹Î± ÎµÏ€Î±Î½ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· hotspot Android
        print("Î–Î·Ï„Î®Î¸Î·ÎºÎµ ÎµÏ€Î±Î½ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· hotspot")

if __name__ == '__main__':
        print("ÎˆÎ½Î±ÏÎ¾Î· server ÏƒÏ„Î¿ http://0.0.0.0:5000/")
        socketio.run(app, host='0.0.0.0', port=5000, debug=True)

        </code></pre>
    </div>
</div>
</div>
</div>
<div class="step" onclick="toggleStep(this)">
        <div class="step-header">
            <div class="step-number">1</div>
            <div class="step-content">
                <h3>Î£ÏÎ½Î´ÎµÏƒÎ· ESP32</h3>
                <p>Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ ÎºÎ±Î»ÏÎ´Î¹Î¿ micro-USB Î³Î¹Î± Î½Î± ÏƒÏ…Î½Î´Î­ÏƒÎµÏ„Îµ Ï„Î¿ ESP32 ÏƒÏ„Î¿Î½ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® ÏƒÎ±Ï‚.</p>
            </div>
        </div>
        <div class="step-drawer">
            <div class="carousel">
                <div class="slides">
                    <div class="slide" style="background-image: url('templates/esp.png');"></div>
                    <div class="slide" style="background-image: url('templates/structured_data_logo.png');"></div>
                </div>
                <div class="dots">
                    <span onclick="goToSlide(this, 0)" class="dot active"></span>
                    <span onclick="goToSlide(this, 1)" class="dot"></span>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    function toggleStep(step) {
step.classList.add("open");
    }

    function goToSlide(dot, index) {
        const dots = dot.parentElement.querySelectorAll('.dot');
        const carousel = dot.closest('.carousel');
        const slides = carousel.querySelector('.slides');

        slides.style.transform = `translateX(-${index * 100}%)`;

        dots.forEach(d => d.classList.remove('active'));
        dot.classList.add('active');
    }
</script>
<script>
    function openDrawer(stepElement) {
        stepElement.classList.add("open");
    }
</script>

</body>
</html>
<div class="footer">
        <p>&copy; 2025 Î Î±ÏÎ¿Ï…ÏƒÎ¯Î±ÏƒÎ· ÎˆÏÎ³Î¿Ï… RC</p>
<p>Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î±Ï€ÏŒ sasimis <a href="">GitHub</a></p>
